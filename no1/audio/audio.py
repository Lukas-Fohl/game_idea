#has to run in another thread